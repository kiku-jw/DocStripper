# DocStripper

Batch document cleaner — удаляет мусор из текстовых документов.

## Описание

DocStripper — это CLI-утилита для массовой очистки текстовых файлов от визуального мусора:
- Повторяющиеся строки
- Номера страниц
- Заголовки и подвалы (например, "Page 3 of 12", "Confidential")
- Пустые строки

Утилита работает полностью офлайн, используя только стандартную библиотеку Python.

## Требования

- Python 3.9 или выше
- Для обработки PDF: рекомендуется установить `pdftotext` (входит в пакет `poppler-utils`)

### Установка pdftotext

**macOS:**
```bash
brew install poppler
```

**Ubuntu/Debian:**
```bash
sudo apt-get install poppler-utils
```

**Windows:**
Скачайте Poppler для Windows с [официального сайта](https://github.com/oschwartz10612/poppler-windows/releases/)

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/yourusername/DocStripper.git
cd DocStripper
```

2. Сделайте файл исполняемым (опционально):
```bash
chmod +x tool.py
```

## Использование

### Базовое использование

Очистить один файл:
```bash
python tool.py document.txt
```

Очистить несколько файлов:
```bash
python tool.py file1.txt file2.txt file3.docx
```

Очистить все текстовые файлы в текущей директории:
```bash
python tool.py *.txt
```

### Режим dry-run (пробный запуск)

Посмотреть, что будет изменено без фактического изменения файлов:
```bash
python tool.py --dry-run document.txt
```

### Откат изменений

Восстановить файлы из последней операции:
```bash
python tool.py --undo
```

### Примеры использования

**Пример 1: Очистка одного документа**
```bash
python tool.py messy_document.txt
# Обработает файл и создаст резервную копию messy_document.txt.bak
```

**Пример 2: Массовая обработка документов**
```bash
python tool.py *.txt *.docx
# Обработает все .txt и .docx файлы в текущей директории
```

**Пример 3: Проверка перед очисткой**
```bash
python tool.py --dry-run important_report.pdf
# Покажет статистику без изменения файла
```

**Пример 4: Обработка PDF файла**
```bash
python tool.py report.pdf
# Извлечет текст и очистит его (требуется pdftotext)
```

**Пример 5: Откат последней операции**
```bash
python tool.py --undo
# Восстановит все файлы из последней операции
```

**Пример 6: Обработка с выводом статистики**
```bash
python tool.py document1.txt document2.txt
# После обработки покажет:
# - Количество обработанных файлов
# - Удаленных строк
# - Свернутых дубликатов
# - Удаленных пустых строк
# - Удаленных заголовков/подвалов
```

## Поддерживаемые форматы

- `.txt` — текстовые файлы (UTF-8, Latin-1)
- `.docx` — документы Microsoft Word (извлечение текста через XML)
- `.pdf` — PDF документы (требуется `pdftotext`)

## Что удаляется

1. **Повторяющиеся строки** — последовательные одинаковые строки
2. **Номера страниц** — строки, содержащие только числа
3. **Заголовки и подвалы** — паттерны типа:
   - "Page X of Y"
   - "Page X"
   - "Confidential"
   - "DRAFT"
4. **Пустые строки** — строки, содержащие только пробелы

## Логирование и откат

Все операции записываются в файл `.strip-log` в формате JSON. Каждая операция включает:
- Список обработанных файлов
- Пути к резервным копиям (.bak)
- Статистику изменений
- Временную метку

Используйте `--undo` для восстановления последней операции.

## Выходные коды

- `0` — успешное выполнение
- `1` — ошибка (файл не найден, ошибка чтения и т.д.)

## Ограничения

- DOCX файлы обрабатываются как простой текст (форматирование теряется)
- PDF файлы требуют наличия `pdftotext` в системе
- Сложное форматирование может быть потеряно при извлечении текста

## Лицензия

MIT License — см. файл LICENSE.txt

## Автор

DocStripper — инструмент для автоматической очистки документов.

